<!-- Modal para selecionar Solado -->
<div class="modal fade" id="modalSolado" tabindex="-1" aria-labelledby="modalSoladoLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Solado</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Campo de filtro -->
                <div class="mb-3">
                    <input type="text" id="filterSolado" class="form-control" placeholder="Filtrar Solado">
                </div>
                <table class="table" id="soladoTable">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for solado in solados_disponiveis %}
                        <tr>
                            <td>{{ solado.referencia }}</td>
                            <td>{{ solado.descricao }}</td>
                            <td>R$ {{ "%.6f"|format(solado.custo_total) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-solado"
                                    data-id="{{ solado.id }}" data-descricao="{{ solado.descricao }}" data-preco="{{ "
                                    %.4f"|format(solado.custo_total) }}"
                                    data-tipo="solado">
                                    Selecionar
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal para selecionar Alça -->
<div class="modal fade" id="modalAlca" tabindex="-1" aria-labelledby="modalAlcaLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Alça</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Campo de filtro -->
                <div class="mb-3">
                    <input type="text" id="filterAlca" class="form-control" placeholder="Filtrar Alça">
                </div>
                <table class="table" id="alcaTable">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for alca in alcas_disponiveis %}
                        <tr>
                            <td>{{ alca.referencia }}</td>
                            <td>{{ alca.descricao }}</td>
                            <td>R$ {{ "%.6f"|format(alca.preco_total) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-alca"
                                    data-id="{{ alca.id }}" data-descricao="{{ alca.descricao }}" data-preco="{{ "
                                    %.4f"|format(alca.preco_total) }}"
                                    data-tipo="alca">
                                    Selecionar
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal para selecionar Componentes -->
<div class="modal fade" id="modalComponentes" tabindex="-1" aria-labelledby="modalComponentesLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Componentes</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Campo de filtro -->
                <div class="mb-3">
                    <input type="text" id="filterComponentes" class="form-control" placeholder="Filtrar Componentes">
                </div>
                <table class="table" id="componentesTable">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for componente in componentes_disponiveis %}
                        <tr>
                            <td>{{ componente.codigo }}</td>
                            <td>{{ componente.descricao }}</td>
                            <td>R$ {{ "%.6f"|format(componente.preco) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-componente"
                                    data-id="{{ componente.id }}" data-descricao="{{ componente.descricao }}"
                                    data-preco="{{ " %.4f"|format(componente.preco) }}"
                                    data-tipo="componente">
                                    Selecionar
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal para selecionar Embalagem 1 -->
<div class="modal fade" id="modalEmbalagem1" tabindex="-1" aria-labelledby="modalEmbalagem1Label" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Embalagem 1</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Filtro para Embalagem 1 -->
                <div class="mb-3">
                    <input type="text" id="filterEmbalagem1" class="form-control" placeholder="Filtrar Embalagem 1">
                </div>
                <table class="table" id="embalagem1Table">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in componentes_disponiveis %}
                        <tr>
                            <td>{{ item.codigo }}</td>
                            <td>{{ item.descricao }}</td>
                            <td>R$ {{ "%.6f"|format(item.preco) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-embalagem"
                                data-id="{{ item.id }}" 
                                data-descricao="{{ item.descricao }}"
                                data-preco="{{ "%.4f"|format(item.preco) }}"
                                data-tipo="embalagem1">
                                Selecionar
                            </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal para selecionar Embalagem 2 -->
<div class="modal fade" id="modalEmbalagem2" tabindex="-1" aria-labelledby="modalEmbalagem2Label" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Embalagem 2</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <input type="text" id="filterEmbalagem2" class="form-control" placeholder="Filtrar Embalagem 2">
                </div>
                <table class="table" id="embalagem2Table">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in componentes_disponiveis %}
                        <tr>
                            <td>{{ item.codigo }}</td>
                            <td>{{ item.descricao }}</td>
                            <td>R$ {{ "%.6f"|format(item.preco) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-embalagem"
                                data-id="{{ item.id }}" 
                                data-descricao="{{ item.descricao }}"
                                data-preco="{{ "%.4f"|format(item.preco) }}"
                                data-tipo="embalagem2">
                                Selecionar
                            </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal para selecionar Embalagem 3 -->
<div class="modal fade" id="modalEmbalagem3" tabindex="-1" aria-labelledby="modalEmbalagem3Label" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Embalagem 3</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Campo de filtro -->
                <div class="mb-3">
                    <input type="text" id="filterEmbalagem3" class="form-control" placeholder="Filtrar Embalagem 3">
                </div>
                <table class="table" id="embalagem3Table">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in componentes_disponiveis %}
                        <tr>
                            <td>{{ item.codigo }}</td>
                            <td>{{ item.descricao }}</td>
                            <td>R$ {{ "%.6f"|format(item.preco) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-embalagem"
                                data-id="{{ item.id }}" 
                                data-descricao="{{ item.descricao }}"
                                data-preco="{{ "%.4f"|format(item.preco) }}"
                                data-tipo="embalagem3">
                                Selecionar
                            </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal para selecionar Custos Operacionais -->
<div class="modal fade" id="modalCustos" tabindex="-1" aria-labelledby="modalCustosLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Custos Operacionais</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Campo de filtro -->
                <div class="mb-3">
                    <input type="text" id="filterCustos" class="form-control" placeholder="Filtrar Custos Operacionais">
                </div>
                <table class="table" id="custosTable">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for custo in custos_disponiveis %}
                        <tr>
                            <td>{{ custo.id }}</td>
                            <td>{{ custo.descricao }}</td>
                            <td>R$ {{ "%.6f"|format(custo.preco) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-custo"
                                    data-id="{{ custo.id }}" data-descricao="{{ custo.descricao }}" data-preco="{{ "
                                    %.4f"|format(custo.preco) }}"
                                    data-tipo="custo">
                                    Selecionar
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal para selecionar Mão de Obra -->
<div class="modal fade" id="modalMaoObra" tabindex="-1" aria-labelledby="modalMaoObraLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Selecionar Mão de Obra</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Campo de filtro -->
                <div class="mb-3">
                    <input type="text" id="filterMaoObra" class="form-control" placeholder="Filtrar Mão de Obra">
                </div>
                <table class="table" id="maoObraTable">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descrição</th>
                            <th>Diária</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for mao in mao_de_obra_disponiveis %}
                        <tr>
                            <td>{{ mao.id }}</td>
                            <td>{{ mao.descricao }}</td>
                            <td>R$ {{ "%.2f"|format(mao.diaria) }}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-sm selecionar-mao"
                                    data-id="{{ mao.id }}" data-descricao="{{ mao.descricao }}" data-diaria="{{ "
                                    %.2f"|format(mao.diaria) }}"
                                    data-tipo="mao_obra">
                                    Selecionar
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Script para filtrar todas as tabelas -->
<script>
    function setupFilter(filterId, tableId) {
        const filterInput = document.getElementById(filterId);
        if (filterInput) {
            filterInput.addEventListener('keyup', function () {
                let filtro = this.value.toUpperCase();
                let rows = document.querySelectorAll('#' + tableId + ' tbody tr');
                rows.forEach(row => {
                    let col1 = row.querySelector('td:nth-child(1)').textContent.toUpperCase();
                    let col2 = row.querySelector('td:nth-child(2)').textContent.toUpperCase();
                    if (col1.indexOf(filtro) > -1 || col2.indexOf(filtro) > -1) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
        }
    }

    // Ativar filtros para todas as tabelas
    setupFilter('filterSolado', 'soladoTable');
    setupFilter('filterAlca', 'alcaTable');
    setupFilter('filterComponentes', 'componentesTable');
    setupFilter('filterEmbalagem1', 'embalagem1Table');
    setupFilter('filterEmbalagem2', 'embalagem2Table');
    setupFilter('filterEmbalagem3', 'embalagem3Table');
    setupFilter('filterCustos', 'custosTable');
    setupFilter('filterMaoObra', 'maoObraTable');
</script>
