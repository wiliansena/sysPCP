{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Cadastro de Refer√™ncia</h2>

    <form method="POST" action="{{ url_for('routes.nova_referencia') }}" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="form-group">
            <label>C√≥digo da Refer√™ncia</label>
            {{ form.codigo_referencia(class="form-control") }}
        </div>

        <div class="form-group">
            <label>Descri√ß√£o</label>
            {{ form.descricao(class="form-control") }}
        </div>

        <div class="form-group">
            <label>Imagem</label>
            {{ form.imagem(class="form-control-file") }}
        </div>

        <h4>Ficha T√©cnica</h4>

        <!-- Bot√µes para abrir os modais -->






        <!-- Tabelas para exibir os itens selecionados -->
        <h4>Itens Selecionados</h4>

        <h4> Solados </h4>
        <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#modalSolado">
            Adicionar Solado
        </button>
        <table class="table table-bordered" id="tabela-solado">
            <thead>
                <tr>
                    <th>C√≥digo</th>
                    <th>Descri√ß√£o</th>
                    <th>Pre√ßo</th>
                    <th>Consumo</th>
                    <th>Pre√ßo Unit√°rio</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <h4>Al√ßas</h4>
        <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#modalAlca">
            Adicionar Al√ßa
        </button>
        <table class="table table-bordered" id="tabela-alca">
            <thead>
                <tr>
                    <th>C√≥digo</th>
                    <th>Descri√ß√£o</th>
                    <th>Pre√ßo</th>
                    <th>Consumo</th>
                    <th>Pre√ßo Unit√°rio</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <h4>Componentes</h4>
        <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#modalComponentes">
            Adicionar Componente
        </button>
        <table class="table table-bordered" id="tabela-componente">
            <thead>
                <tr>
                    <th>C√≥digo</th>
                    <th>Descri√ß√£o</th>
                    <th>Pre√ßo</th>
                    <th>Consumo</th>
                    <th>Pre√ßo Unit√°rio</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <h4>Custos Operacionais( FIXOS/INDIRETOS ) </h4>
        <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#modalCustos">
            Adicionar Custos
        </button>
        <table class="table table-bordered" id="tabela-custo">
            <thead>
                <tr>
                    <th>C√≥digo</th>
                    <th>Descri√ß√£o</th>
                    <th>Pre√ßo</th>
                    <th>Consumo</th>
                    <th>Pre√ßo Unit√°rio</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <h4> Custo M√£o de Obra</h4>
        <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#modalMaoObra">
            Adicionar M√£o de Obra
        </button>
        <h4>Custo M√£o de Obra</h4>
        <table class="table table-bordered" id="tabela-mao_obra">
            <thead>
                <tr>
                    <th>C√≥digo</th>
                    <th>Descri√ß√£o</th>
                    <th>Di√°ria</th>
                    <th>Consumo</th>
                    <th>Produ√ß√£o</th>
                    <th>Pre√ßo Unit√°rio</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>
            <tbody>
                <!-- Itens adicionados dinamicamente aqui -->
            </tbody>
        </table>


        <!-- Tabela de Resumo dos Custos -->
        <h4>Resumo de Custos</h4>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Categoria</th>
                    <th>Total (R$)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Solado</td>
                    <td id="total_solado">0.00</td>
                </tr>
                <tr>
                    <td>Al√ßas</td>
                    <td id="total_alcas">0.00</td>
                </tr>
                <tr>
                    <td>Componentes</td>
                    <td id="total_componentes">0.00</td>
                </tr>
                <tr>
                    <td>Custos Operacionais</td>
                    <td id="total_custos">0.00</td>
                </tr>
                <tr>
                    <td>M√£o de Obra</td>
                    <td id="total_mao_obra">0.00</td>
                </tr>
            </tbody>
        </table>


        <button type="submit" class="btn btn-success">Salvar</button>
        <a href="{{ url_for('routes.listar_referencias') }}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>

<p>Solados carregados: {{ solados }}</p>
<p>Al√ßas carregadas: {{ alcas }}</p>
<p>Componentes carregados: {{ componentes }}</p>
<p>Custos carregados: {{ custos_operacionais }}</p>

<!-- üîπ Modais para sele√ß√£o de itens -->
{% include 'modais_referencia.html' %}

<script src="{{ url_for('static', filename='js/referencia.js') }}"></script>

{% endblock %}